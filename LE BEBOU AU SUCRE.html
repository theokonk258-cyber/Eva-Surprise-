<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pour Eva 💌</title>
  <meta name="color-scheme" content="light only">
  <style>
    html, body { height: 100%; margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, "Noto Sans", "Apple Color Emoji"; background: #fff5f8; color:#222; }
    .wrap { min-height: 100%; display: grid; place-items: center; padding: 24px; }
    .card { background: white; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,.12); padding: 28px 24px; max-width: 620px; width: 100%; text-align: center; }
    h1 { margin: 0 0 8px; font-size: 28px; }
    p { margin: 0; line-height: 1.6; font-size: 18px; }
    .btn { appearance: none; border: 0; background: linear-gradient(180deg,#ff5ea8,#ff3a7f); color: white; padding: 14px 22px; border-radius: 999px; font-size: 18px; cursor: pointer; box-shadow: 0 8px 18px rgba(255,58,127,.35); transition: transform .06s ease; -webkit-tap-highlight-color: transparent; }
    .btn:hover { transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .muted { color:#666; font-size: 14px; margin-top: 10px; }

    .hidden { display: none; }

    /* Floating hearts created dynamically */
    .heart {
      position: fixed;
      width: 14px; height: 14px;
      background: #ff3a7f;
      transform: rotate(45deg);
      left: 50%; top: 50%;
      pointer-events: none;
      opacity: 0.9;
      animation: floatUp 1400ms ease-out forwards;
      z-index: 9999;
    }
    .heart:before, .heart:after {
      content: "";
      position: absolute;
      width: 14px; height: 14px;
      background: #ff3a7f;
      border-radius: 50%;
    }
    .heart:before { left: -7px; top: 0; }
    .heart:after  { left: 0; top: -7px; }

    @keyframes floatUp {
      0%   { transform: translate(0,0) rotate(45deg); opacity: 1; }
      80%  { opacity: 0.9; }
      100% { transform: translate(var(--dx), var(--dy)) scale(0.9) rotate(45deg); opacity: 0; }
    }

    .note {
      font-size: 22px;
      margin-top: 12px;
      min-height: 3.5em;
      white-space: pre-wrap;
    }
    .controls { margin-top: 16px; display: flex; gap: 8px; justify-content: center; }
    .link {
      font-size: 14px; text-decoration: underline; color: #d21862; cursor: pointer; background: transparent; border: 0; padding: 6px 10px;
    }

    .footer {
      text-align: center; font-size: 12px; color: #888; margin-top: 16px;
    }

    noscript { display:block; background:#fff0f6; border:1px solid #ffc2d8; color:#b30052; padding:10px 14px; border-radius:10px; margin:14px auto; max-width: 620px; }
  </style>
</head>
<body>
  <noscript>Pour voir l'animation, ouvre cette page dans un navigateur (Safari/Chrome) : l'affichage d'aperçu d'une app ou d'un webmail peut bloquer les scripts.</noscript>
  <div class="wrap">
    <div class="card">
      <div id="start">
        <h1>Une petite surprise pour toi 💖</h1>
        <p class="muted">Clique pour ouvrir mon mot d'amour</p>
        <div style="margin-top:16px">
          <button id="open" class="btn">Ouvrir 💌</button>
        </div>
      </div>

      <div id="message" class="hidden">
        <h1>Pour toi, Eva</h1>
        <div id="typed" class="note"></div>
        <div class="controls">
          <button id="replay" class="link">Rejouer l'animation</button>
          <button id="copy" class="link">Copier le message</button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">Fait avec amour par Théo 💖</div>

<script>
  // === Personnalise ici ===
  const message = "Eva, je t'aime pour tout ce que tu es, pour chaque sourire et chaque petite attention.\\nMerci d'être toi. 💕\\n\\n— Théo";

  const openBtn   = document.getElementById('open');
  const replayBtn = document.getElementById('replay');
  const copyBtn   = document.getElementById('copy');
  const start     = document.getElementById('start');
  const msgBlock  = document.getElementById('message');
  const typed     = document.getElementById('typed');

  function rand(min, max) { return Math.random() * (max - min) + min; }

  function spawnHeart(x, y) {
    const h = document.createElement('span');
    h.className = 'heart';
    const dx = rand(-180, 180);
    const dy = rand(-240, -120);
    h.style.left = x + 'px';
    h.style.top  = y + 'px';
    h.style.setProperty('--dx', dx + 'px');
    h.style.setProperty('--dy', dy + 'px');
    h.style.filter = `hue-rotate(${rand(-20, 20)}deg) saturate(${rand(0.9, 1.3)})`;
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 1400);
  }

  function burstHearts(cx, cy, count=28) {
    for (let i=0; i<count; i++) {
      setTimeout(() => spawnHeart(cx + rand(-10,10), cy + rand(-10,10)), i * 16);
    }
  }

  function typeText(text, speed=20) {
    return new Promise(resolve => {
      typed.textContent = "";
      let i = 0;
      const tick = () => {
        typed.textContent = text.slice(0, i++);
        if (i <= text.length) {
          setTimeout(tick, text[i-1] === '\n' ? speed*2 : speed);
        } else {
          resolve();
        }
      };
      tick();
    });
  }

  function play() {
    // hearts burst from button center (or center of screen if unknown)
    const rect = openBtn ? openBtn.getBoundingClientRect() : { left: innerWidth/2, top: innerHeight/2, width:0, height:0 };
    const cx = rect.left + rect.width/2;
    const cy = rect.top  + rect.height/2;
    burstHearts(cx, cy, 36);

    start.classList.add('hidden');
    msgBlock.classList.remove('hidden');
    typeText(message);
  }

  openBtn?.addEventListener('click', play);
  replayBtn?.addEventListener('click', () => {
    typed.textContent = "";
    msgBlock.classList.add('hidden');
    start.classList.remove('hidden');
  });

  copyBtn?.addEventListener('click', async () => {
    try {
      await navigator.clipboard.writeText(message.replaceAll("\\n", "\n"));
      copyBtn.textContent = "Copié ✅";
      setTimeout(() => copyBtn.textContent = "Copier le message", 1400);
    } catch (e) {
      alert("Copie impossible ici. Sélectionne le texte et copie-le manuellement ❤️");
    }
  });

  // gentle background hearts
  setTimeout(() => {
    const periodic = () => burstHearts(innerWidth*0.5, innerHeight*0.75, 6);
    periodic();
    setInterval(periodic, 2600);
  }, 500);
</script>
</body>
</html>
